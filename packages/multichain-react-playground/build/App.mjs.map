{"version":3,"file":"App.mjs","sourceRoot":"","sources":["../src/App.tsx"],"names":[],"mappings":";;;AAGA,OAAO,EAAE,MAAM,EAAE,wBAAc;AAC/B,OAAO,aAAa,EAAE,EAAE,gBAAgB,EAAE,uCAAmC;AAC7E,OAAO,EAAE,iBAAiB,EAAE,iCAA6B;AACzD,OAAO,EAAE,SAAS,EAAE,mCAA+B;AACnD,OAAO,EAAE,MAAM,EAAE,eAAe;AAEhC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;AAEvB,SAAS,GAAG;IACX,MAAM,CAAC,YAAY,EAAE,eAAe,CAAC,GAAG,QAAQ,CAAW,CAAC,UAAU,CAAC,CAAC,CAAC;IACzE,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAG,QAAQ,CAAkB,EAAE,CAAC,CAAC;IAC1E,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,UAAU,EAAE,aAAa,EAAE,GAAG,MAAM,EAAE,CAAC;IAE3F,MAAM,oBAAoB,GAAG,WAAW,CACvC,CAAC,KAAa,EAAE,SAAkB,EAAE,EAAE;QACrC,IAAI,SAAS,EAAE;YACd,eAAe,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;SAC/D;aAAM;YACN,eAAe,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC;SAC/D;IACF,CAAC,EACD,CAAC,YAAY,CAAC,CACd,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACd,IAAI,OAAO,EAAE;YACZ,MAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,aAAa,IAAI,EAAE,CAAC,CAAC;YACzD,eAAe,CAAC,MAAM,CAAC,CAAC;YAExB,0CAA0C;YAC1C,MAAM,WAAW,GAAoB,EAAE,CAAC;YACxC,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;gBAC3B,MAAM,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAC,aAAa,EAAE,CAAC,KAA2C,CAAC,IAAI,EAAE,CAAC;gBAChG,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;oBACpC,WAAW,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,CAAC;iBAC9B;aACD;YACD,iBAAiB,CAAC,WAAW,CAAC,CAAC;SAC/B;IACF,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEd,MAAM,iBAAiB,GAAG,WAAW,CAAC,GAAG,EAAE;QAC1C,IAAI,CAAC,OAAO;YAAE,OAAO,KAAK,CAAC;QAC3B,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,aAAa,IAAI,EAAE,CAAC,CAAC;QAChE,MAAM,aAAa,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACnE,IAAI,aAAa,CAAC,MAAM,KAAK,aAAa,CAAC,MAAM;YAAE,OAAO,IAAI,CAAC;QAC/D,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;IACzI,CAAC,EAAE,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC,CAAC;IAE5B,MAAM,OAAO,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;QACtC,MAAM,mBAAmB,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACzE,MAAM,kBAAkB,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;QAC/E,OAAO,UAAU,CAAC,mBAA8B,EAAE,kBAAqC,CAAC,CAAC;IAC1F,CAAC,EAAE,CAAC,YAAY,EAAE,cAAc,EAAE,UAAU,CAAC,CAAC,CAAC;IAE/C,MAAM,UAAU,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;QACzC,MAAM,aAAa,EAAE,CAAC;IACvB,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;IAEpB,MAAM,gBAAgB,GAAG,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAAoC,CAAC,GAAG,EAAE,WAAW,EAAE,EAAE;QACtH,MAAM,gBAAgB,GAAG,iBAAiB,CAAC,WAA6C,CAAC,CAAC;QAC1F,GAAG,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,gBAAgB,EAAE,CAAC,CAAC;QACzD,OAAO,GAAG,CAAC;IACZ,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,MAAM,cAAc,GAAG,KAAK,KAAK,cAAc,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,QAAQ,CAAC;IAC7F,MAAM,WAAW,GAAG,KAAK,KAAK,WAAW,CAAC;IAC1C,MAAM,YAAY,GAAG,KAAK,KAAK,YAAY,CAAC;IAC5C,OAAO,CACN,cAAK,SAAS,EAAC,6CAA6C,YAC3D,eAAK,SAAS,EAAC,sBAAsB,aACpC,aAAI,SAAS,EAAC,oDAAoD,kDAAuC,EACzG,mBAAS,SAAS,EAAC,wCAAwC,aAC1D,cAAK,SAAS,EAAC,MAAM,YACpB,KAAC,aAAa,IAAC,gBAAgB,EAAE,gBAAgB,EAAE,UAAU,EAAE,YAAY,EAAE,oBAAoB,EAAE,oBAAoB,EAAE,KAAK,EAAE,gBAAgB,CAAC,KAAK,GAAI,GACrJ,EAEL,YAAY,IAAI,CAChB,iBAAQ,IAAI,EAAC,QAAQ,EAAC,OAAO,EAAE,OAAO,EAAE,SAAS,EAAC,6FAA6F,2BAEtI,CACT,EAEA,cAAc,IAAI,CAClB,iBAAQ,IAAI,EAAC,QAAQ,EAAC,OAAO,EAAE,OAAO,EAAE,SAAS,EAAC,6FAA6F,wBAEtI,CACT,EAEA,WAAW,IAAI,CACf,iBACC,IAAI,EAAC,QAAQ,EACb,OAAO,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,UAAU,EACnD,SAAS,EAAC,wFAAwF,YAEjG,iBAAiB,EAAE,CAAC,CAAC,CAAC,4BAA4B,CAAC,CAAC,CAAC,YAAY,GAC1D,CACT,IACQ,EACT,KAAK,IAAI,CACT,mBAAS,SAAS,EAAC,wCAAwC,aAC1D,aAAI,SAAS,EAAC,sCAAsC,sBAAW,EAC/D,YAAG,SAAS,EAAC,eAAe,YAAE,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAK,IAClD,CACV,EACD,kBAAS,SAAS,EAAC,wCAAwC,YACzD,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,aAAa,IAAI,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CACxD,mBAAS,SAAS,EAAC,MAAM,aACxB,aAAI,SAAS,EAAC,uCAAuC,mCAAwB,EAC7E,cAAK,SAAS,EAAC,sDAAsD,YACnE,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE,EAAE;oCACtE,OAAO,KAAC,SAAS,IAAa,KAAK,EAAE,KAAc,EAAE,OAAO,EAAE,OAA8C,IAArF,KAAK,CAAoF,CAAC;gCAClH,CAAC,CAAC,GACG,IACG,CACV,GACQ,IACL,GACD,CACN,CAAC;AACH,CAAC;AAED,eAAe,GAAG,CAAC","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport type { Scope, SessionData } from '@metamask/multichain';\nimport type { CaipAccountId } from '@metamask/utils';\nimport { useSDK } from './sdk';\nimport DynamicInputs, { INPUT_LABEL_TYPE } from './components/DynamicInputs';\nimport { FEATURED_NETWORKS } from './constants/networks';\nimport { ScopeCard } from './components/ScopeCard';\nimport { Buffer } from 'buffer';\n\nglobal.Buffer = Buffer;\n\nfunction App() {\n\tconst [customScopes, setCustomScopes] = useState<string[]>(['eip155:1']);\n\tconst [caipAccountIds, setCaipAccountIds] = useState<CaipAccountId[]>([]);\n\tconst { error, state, session, connect: sdkConnect, disconnect: sdkDisconnect } = useSDK();\n\n\tconst handleCheckboxChange = useCallback(\n\t\t(value: string, isChecked: boolean) => {\n\t\t\tif (isChecked) {\n\t\t\t\tsetCustomScopes(Array.from(new Set([...customScopes, value])));\n\t\t\t} else {\n\t\t\t\tsetCustomScopes(customScopes.filter((item) => item !== value));\n\t\t\t}\n\t\t},\n\t\t[customScopes],\n\t);\n\n\tuseEffect(() => {\n\t\tif (session) {\n\t\t\tconst scopes = Object.keys(session?.sessionScopes ?? {});\n\t\t\tsetCustomScopes(scopes);\n\n\t\t\t// Accumulate all accounts from all scopes\n\t\t\tconst allAccounts: CaipAccountId[] = [];\n\t\t\tfor (const scope of scopes) {\n\t\t\t\tconst { accounts } = session.sessionScopes?.[scope as keyof typeof session.sessionScopes] ?? {};\n\t\t\t\tif (accounts && accounts.length > 0) {\n\t\t\t\t\tallAccounts.push(...accounts);\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetCaipAccountIds(allAccounts);\n\t\t}\n\t}, [session]);\n\n\tconst scopesHaveChanged = useCallback(() => {\n\t\tif (!session) return false;\n\t\tconst sessionScopes = Object.keys(session?.sessionScopes ?? {});\n\t\tconst currentScopes = customScopes.filter((scope) => scope.length);\n\t\tif (sessionScopes.length !== currentScopes.length) return true;\n\t\treturn !sessionScopes.every((scope) => currentScopes.includes(scope)) || !currentScopes.every((scope) => sessionScopes.includes(scope));\n\t}, [session, customScopes]);\n\n\tconst connect = useCallback(async () => {\n\t\tconst selectedScopesArray = customScopes.filter((scope) => scope.length);\n\t\tconst filteredAccountIds = caipAccountIds.filter((addr) => addr.trim() !== '');\n\t\treturn sdkConnect(selectedScopesArray as Scope[], filteredAccountIds as CaipAccountId[]);\n\t}, [customScopes, caipAccountIds, sdkConnect]);\n\n\tconst disconnect = useCallback(async () => {\n\t\tawait sdkDisconnect();\n\t}, [sdkDisconnect]);\n\n\tconst availableOptions = Object.keys(FEATURED_NETWORKS).reduce<{ name: string; value: string }[]>((all, networkName) => {\n\t\tconst networkCaipValue = FEATURED_NETWORKS[networkName as keyof typeof FEATURED_NETWORKS];\n\t\tall.push({ name: networkName, value: networkCaipValue });\n\t\treturn all;\n\t}, []);\n\n\tconst isDisconnected = state === 'disconnected' || state === 'pending' || state === 'loaded';\n\tconst isConnected = state === 'connected';\n\tconst isConnecting = state === 'connecting';\n\treturn (\n\t\t<div className=\"min-h-screen bg-gray-50 flex justify-center\">\n\t\t\t<div className=\"max-w-6xl w-full p-8\">\n\t\t\t\t<h1 className=\"text-slate-800 text-4xl font-bold mb-8 text-center\">MetaMask MultiChain API Test Dapp</h1>\n\t\t\t\t<section className=\"bg-white rounded-lg p-8 mb-6 shadow-sm\">\n\t\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t\t<DynamicInputs availableOptions={availableOptions} inputArray={customScopes} handleCheckboxChange={handleCheckboxChange} label={INPUT_LABEL_TYPE.SCOPE} />\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{isConnecting && (\n\t\t\t\t\t\t<button type=\"button\" onClick={connect} className=\"bg-blue-500 text-white px-5 py-2 rounded text-base mr-2 hover:bg-blue-600 transition-colors\">\n\t\t\t\t\t\t\tConnecting\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{isDisconnected && (\n\t\t\t\t\t\t<button type=\"button\" onClick={connect} className=\"bg-blue-500 text-white px-5 py-2 rounded text-base mr-2 hover:bg-blue-600 transition-colors\">\n\t\t\t\t\t\t\tConnect\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{isConnected && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={scopesHaveChanged() ? connect : disconnect}\n\t\t\t\t\t\t\tclassName=\"bg-blue-500 text-white px-5 py-2 rounded text-base hover:bg-blue-600 transition-colors\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{scopesHaveChanged() ? `Re Establishing Connection` : `Disconnect`}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\t\t\t\t</section>\n\t\t\t\t{error && (\n\t\t\t\t\t<section className=\"bg-white rounded-lg p-8 mb-6 shadow-sm\">\n\t\t\t\t\t\t<h2 className=\"text-2xl font-bold text-red-600 mb-4\">Error</h2>\n\t\t\t\t\t\t<p className=\"text-gray-700\">{error.message.toString()}</p>\n\t\t\t\t\t</section>\n\t\t\t\t)}\n\t\t\t\t<section className=\"bg-white rounded-lg p-8 mb-6 shadow-sm\">\n\t\t\t\t\t{Object.keys(session?.sessionScopes ?? {}).length > 0 && (\n\t\t\t\t\t\t<section className=\"mb-6\">\n\t\t\t\t\t\t\t<h2 className=\"text-2xl font-bold text-gray-800 mb-6\">Connected Networks</h2>\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n\t\t\t\t\t\t\t\t{Object.entries(session?.sessionScopes ?? {}).map(([scope, details]) => {\n\t\t\t\t\t\t\t\t\treturn <ScopeCard key={scope} scope={scope as Scope} details={details as SessionData['sessionScopes'][Scope]} />;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t)}\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default App;\n"]}